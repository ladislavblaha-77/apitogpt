<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß© MCP Builder - LKOD s Instrukcemi</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .code-block { background: #1e1e1e; border-radius: 8px; overflow: auto; max-height: 500px; }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>
    <script type="text/babel">
        const { useState } = React;

        function MCPBuilder() {
            const [url, setUrl] = useState('https://api.opendata.praha.eu/lod');
            const [name, setName] = useState('');
            const [description, setDescription] = useState('');
            const [result, setResult] = useState(null);
            const [instructions, setInstructions] = useState(null);

            const generateInstructions = (publisherFilter) => {
                const publisherName = publisherFilter ? publisherFilter.toUpperCase() : 'Praha';
                
                return `Jsi asistent pro Lok√°ln√≠ katalog otev≈ôen√Ωch dat (LKOD) ${publisherName}.

D≈ÆLE≈ΩIT√â OMEZEN√ç API:
- LKOD poskytuje pouze METADATA katalogu, ne seznamy dataset≈Ø
- Endpoint /datasets ƒçasto vrac√≠ pr√°zdn√© pole nebo selh√°v√°
- API NEPODPORUJE vyhled√°v√°n√≠ podle kl√≠ƒçov√Ωch slov
- API NEPODPORUJE filtrov√°n√≠ podle t√©matu

CO M≈Æ≈ΩE≈†:
‚úÖ Zavolat getCatalog pro metadata o katalogu
‚úÖ Zobrazit n√°zev katalogu, poskytovatele, domovskou str√°nku
‚úÖ Vysvƒõtlit u≈æivateli, kde najde konkr√©tn√≠ datasety

CO NEM≈Æ≈ΩE≈†:
‚ùå Vyhled√°vat datasety podle kl√≠ƒçov√Ωch slov
‚ùå Filtrovat podle t√©matu (doprava, finance, atd.)
‚ùå Z√≠skat seznam dataset≈Ø p≈ôes toto API

JAK ODPOV√çDAT:

Kdy≈æ se u≈æivatel pt√° na konkr√©tn√≠ datasety:
"LKOD API poskytuje jen metadata katalogu. Pro prohl√≠≈æen√≠ dataset≈Ø nav≈°tivte:
‚Üí https://opendata.praha.eu/datasets (webov√© rozhran√≠ s vyhled√°v√°n√≠m)
‚Üí Nebo mohu pomoci s Golemio API pro real-time data"

Kdy≈æ getDatasets vr√°t√≠ pr√°zdn√© pole:
"API nevrac√≠ seznam dataset≈Ø. Doporuƒçuji nav≈°t√≠vit https://opendata.praha.eu kde m≈Ø≈æete prohl√≠≈æet v≈°echny datasety."

ZKRATKA:
LKOD = katalog metadat (statick√Ω, bez vyhled√°v√°n√≠)
Web opendata.praha.eu = prohl√≠≈æen√≠ dataset≈Ø (s filtry)
Golemio API = real-time data (api.golemio.cz)`;
            };

            const generateLKODSpec = (baseUrl, customName, customDescription, publisherFilter) => {
                const catalogParams = [
                    {
                        name: "format",
                        in: "query",
                        required: true,
                        schema: { type: "string", enum: ["json"], default: "json" },
                        description: "Form√°t odpovƒõdi"
                    }
                ];

                if (publisherFilter) {
                    catalogParams.push({
                        name: "publishers[]",
                        in: "query",
                        required: true,
                        schema: { type: "string", enum: [publisherFilter], default: publisherFilter },
                        description: `Filtr poskytovatele (${publisherFilter})`
                    });
                }

                return {
                    openapi: "3.1.0",
                    info: {
                        title: customName || `LKOD Metadata API - ${publisherFilter ? publisherFilter.toUpperCase() : 'Praha'}`,
                        description: customDescription || `API pro metadata katalogu otev≈ôen√Ωch dat${publisherFilter ? ' (' + publisherFilter.toUpperCase() + ')' : ''}`,
                        version: "1.0.0"
                    },
                    "x-mcp": {
                        name: (customName || `lkod_${publisherFilter || 'metadata'}`).toLowerCase().replace(/\s+/g, '_'),
                        description: customDescription || `LKOD metadata ${publisherFilter ? publisherFilter.toUpperCase() : ''}`
                    },
                    servers: [{ url: baseUrl, description: "LKOD API endpoint" }],
                    paths: {
                        "/catalog": {
                            get: {
                                operationId: "getCatalog",
                                summary: "Metadata katalogu",
                                description: `Metadata o katalogu${publisherFilter ? ' pro ' + publisherFilter.toUpperCase() : ''}`,
                                parameters: catalogParams,
                                responses: {
                                    "200": {
                                        description: "Metadata katalogu",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    type: "object",
                                                    properties: {
                                                        iri: { type: "string" },
                                                        title: { type: "object" },
                                                        description: { type: "object" },
                                                        homepage: { type: "string" },
                                                        publisher: { type: "object" },
                                                        datasets: { type: "array", items: { type: "string" } }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "/datasets": {
                            get: {
                                operationId: "getDatasets",
                                summary: "Pokus o z√≠sk√°n√≠ dataset≈Ø",
                                description: "VAROV√ÅN√ç: Tento endpoint ƒçasto vrac√≠ pr√°zdn√© pole. Pou≈æijte web opendata.praha.eu m√≠sto toho.",
                                parameters: catalogParams,
                                responses: {
                                    "200": {
                                        description: "Seznam dataset≈Ø (ƒçasto pr√°zdn√Ω)",
                                        content: { "application/json": { schema: { type: "array" } } }
                                    }
                                }
                            }
                        }
                    }
                };
            };

            const handleGenerate = () => {
                let cleanUrl = url.trim();
                let publisherParam = null;
                
                if (cleanUrl.includes('?publishers')) {
                    const urlParts = cleanUrl.split('?');
                    cleanUrl = urlParts[0];
                    const params = new URLSearchParams(urlParts[1]);
                    publisherParam = params.get('publishers[]');
                }
                
                cleanUrl = cleanUrl.replace(/\/$/, '');
                if (cleanUrl.endsWith('/catalog')) {
                    cleanUrl = cleanUrl.slice(0, -'/catalog'.length);
                }
                
                setResult(generateLKODSpec(cleanUrl, name, description, publisherParam));
                setInstructions(generateInstructions(publisherParam));
            };

            const copyToClipboard = (text, message) => {
                navigator.clipboard.writeText(text);
                alert(message);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 py-8 px-4">
                    <div className="max-w-6xl mx-auto">
                        <div className="gradient-bg text-white rounded-2xl shadow-2xl p-8 mb-8">
                            <h1 className="text-4xl font-bold mb-3">üß© MCP Builder</h1>
                            <p className="text-lg opacity-90">Generator pro LKOD s Instrukcemi pro ChatGPT</p>
                        </div>

                        <div className="bg-white rounded-2xl shadow-xl p-8 mb-8">
                            <h2 className="text-2xl font-bold text-gray-800 mb-6">‚öôÔ∏è Konfigurace</h2>
                            <div className="space-y-5">
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">URL LKOD API *</label>
                                    <input
                                        type="text"
                                        value={url}
                                        onChange={(e) => setUrl(e.target.value)}
                                        placeholder="https://api.opendata.praha.eu/lod/catalog?publishers[]=mhmp"
                                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">N√°zev (voliteln√©)</label>
                                    <input
                                        type="text"
                                        value={name}
                                        onChange={(e) => setName(e.target.value)}
                                        placeholder="LKOD Metadata API"
                                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">Popis (voliteln√©)</label>
                                    <textarea
                                        value={description}
                                        onChange={(e) => setDescription(e.target.value)}
                                        placeholder="API pro metadata katalogu..."
                                        rows="2"
                                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none"
                                    />
                                </div>
                            </div>
                            <button
                                onClick={handleGenerate}
                                disabled={!url}
                                className="w-full mt-6 bg-gradient-to-r from-purple-600 to-blue-600 text-white font-bold py-4 rounded-lg hover:from-purple-700 hover:to-blue-700 disabled:opacity-50"
                            >
                                üöÄ Generovat
                            </button>
                        </div>

                        {instructions && (
                            <div className="bg-white rounded-2xl shadow-xl p-8 mb-8">
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="text-2xl font-bold text-gray-800">üìù 1. Instrukce pro ChatGPT</h3>
                                    <button
                                        onClick={() => copyToClipboard(instructions, '‚úÖ Instrukce zkop√≠rov√°ny!')}
                                        className="bg-purple-600 text-white px-5 py-2 rounded-lg hover:bg-purple-700 font-semibold"
                                    >
                                        üìã Kop√≠rovat
                                    </button>
                                </div>
                                <div className="bg-purple-50 border-2 border-purple-300 rounded-lg p-4 mb-4">
                                    <p className="text-purple-900 font-semibold">üí° Vlo≈æte do pole "Instructions" v GPT Builder</p>
                                </div>
                                <div className="bg-gray-900 rounded-lg p-6">
                                    <pre className="text-gray-100 text-sm whitespace-pre-wrap">{instructions}</pre>
                                </div>
                            </div>
                        )}

                        {result && (
                            <div className="bg-white rounded-2xl shadow-xl p-8">
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="text-2xl font-bold text-gray-800">‚úÖ 2. OpenAPI Specifikace</h3>
                                    <div className="flex gap-3">
                                        <button
                                            onClick={() => copyToClipboard(JSON.stringify(result, null, 2), '‚úÖ Specifikace zkop√≠rov√°na!')}
                                            className="bg-blue-600 text-white px-5 py-2 rounded-lg hover:bg-blue-700 font-semibold"
                                        >
                                            üìã Kop√≠rovat
                                        </button>
                                        <button
                                            onClick={() => {
                                                const blob = new Blob([JSON.stringify(result, null, 2)], { type: 'application/json' });
                                                const url = URL.createObjectURL(blob);
                                                const a = document.createElement('a');
                                                a.href = url;
                                                a.download = 'lkod-spec.json';
                                                a.click();
                                                URL.revokeObjectURL(url);
                                            }}
                                            className="bg-green-600 text-white px-5 py-2 rounded-lg hover:bg-green-700 font-semibold"
                                        >
                                            üíæ St√°hnout
                                        </button>
                                    </div>
                                </div>
                                <div className="bg-green-50 border-2 border-green-300 rounded-lg p-4 mb-4">
                                    <p className="text-green-900 font-semibold mb-2">üí° Vlo≈æte do "Actions" ‚Üí "Schema" v GPT Builder</p>
                                    <p className="text-sm text-green-800">Base URL: <code className="bg-white px-2 py-1 rounded">{result.servers[0].url}</code></p>
                                    {result.paths["/catalog"].get.parameters.find(p => p.name === "publishers[]") && (
                                        <p className="text-sm text-green-800 mt-1">
                                            Filtr: <code className="bg-white px-2 py-1 rounded">
                                                {result.paths["/catalog"].get.parameters.find(p => p.name === "publishers[]").schema.default}
                                            </code>
                                        </p>
                                    )}
                                </div>
                                <div className="code-block p-6">
                                    <pre className="text-green-400 text-sm">{JSON.stringify(result, null, 2)}</pre>
                                </div>
                                <div className="mt-6 p-6 bg-blue-50 rounded-lg border-2 border-blue-200">
                                    <h4 className="font-bold text-blue-900 mb-3">üéØ Postup nastaven√≠:</h4>
                                    <ol className="list-decimal list-inside space-y-2 text-blue-800">
                                        <li><strong>Zkop√≠rujte Instrukce</strong> v√Ω≈°e ‚Üí vlo≈æte do "Instructions"</li>
                                        <li><strong>Zkop√≠rujte Specifikaci</strong> ‚Üí vlo≈æte do "Actions" ‚Üí "Schema"</li>
                                        <li>Authentication: <strong>None</strong></li>
                                        <li>Ulo≈æte a testujte</li>
                                    </ol>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        ReactDOM.render(<MCPBuilder />, document.getElementById('root'));
    </script>
</body>
</html>