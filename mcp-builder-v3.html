<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß© MCP Builder - Auto-Generator ChatGPT Actions</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .code-block {
            background: #1e1e1e;
            border-radius: 8px;
            overflow: auto;
            max-height: 500px;
        }
        .loader {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        function MCPBuilder() {
            const [url, setUrl] = useState('https://api.opendata.praha.eu/lod');
            const [authType, setAuthType] = useState('none');
            const [defaultFormat, setDefaultFormat] = useState('json');
            const [name, setName] = useState('');
            const [description, setDescription] = useState('');
            const [loading, setLoading] = useState(false);
            const [result, setResult] = useState(null);
            const [infoMessages, setInfoMessages] = useState([]);

            const generateOpenAPISpec = (apiUrl, customName, customDescription, format) => {
                const spec = {
                    openapi: "3.1.0",
                    info: {
                        title: customName || "LKOD MCP Server",
                        description: customDescription || "MCP server pro p≈ô√≠stup k otev≈ôen√Ωm dat≈Øm p≈ôes LKOD API (JSON re≈æim).",
                        version: "1.0.0"
                    },
                    "x-mcp": {
                        name: (customName || "lkod_api").toLowerCase().replace(/\s+/g, '_'),
                        description: customDescription || "LKOD MCP Server ‚Äì p≈ô√≠stup k dat≈Øm Prahy (form√°t JSON)"
                    },
                    servers: [
                        {
                            url: apiUrl,
                            description: "LKOD Open Data API - JSON re≈æim"
                        }
                    ],
                    paths: {
                        "/catalog": {
                            get: {
                                operationId: "getCatalogLKOD",
                                summary: "Z√≠skat katalog dat (JSON form√°t)",
                                parameters: [
                                    {
                                        name: "format",
                                        in: "query",
                                        required: true,
                                        schema: {
                                            type: "string",
                                            enum: [format],
                                            default: format
                                        },
                                        description: "Form√°t odpovƒõdi (v≈ædy json)"
                                    },
                                    {
                                        name: "publishers[]",
                                        in: "query",
                                        required: false,
                                        schema: {
                                            type: "string"
                                        },
                                        description: "Filtruje katalog podle identifik√°toru publishera"
                                    },
                                    {
                                        name: "limit",
                                        in: "query",
                                        required: false,
                                        schema: {
                                            type: "integer"
                                        },
                                        description: "Maxim√°ln√≠ poƒçet v√Ωsledk≈Ø"
                                    },
                                    {
                                        name: "offset",
                                        in: "query",
                                        required: false,
                                        schema: {
                                            type: "integer"
                                        },
                                        description: "Offset pro str√°nkov√°n√≠"
                                    }
                                ],
                                responses: {
                                    "200": {
                                        description: "√öspƒõ≈°n√° odpovƒõƒè (ƒçist√Ω JSON)",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    type: "object",
                                                    properties: {
                                                        iri: {
                                                            type: "string",
                                                            description: "IRI katalogu"
                                                        },
                                                        title: {
                                                            type: "string",
                                                            description: "N√°zev katalogu"
                                                        },
                                                        description: {
                                                            type: "string",
                                                            description: "Popis katalogu"
                                                        },
                                                        datasets: {
                                                            type: "array",
                                                            description: "Seznam IRI datov√Ωch sad",
                                                            items: {
                                                                type: "string"
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "/datasets": {
                            get: {
                                operationId: "getDatasetListLKOD",
                                summary: "Z√≠skat seznam datov√Ωch sad (JSON form√°t)",
                                parameters: [
                                    {
                                        name: "format",
                                        in: "query",
                                        required: true,
                                        schema: {
                                            type: "string",
                                            enum: [format],
                                            default: format
                                        },
                                        description: "Form√°t odpovƒõdi (v≈ædy json)"
                                    },
                                    {
                                        name: "publisher",
                                        in: "query",
                                        required: false,
                                        schema: {
                                            type: "string"
                                        },
                                        description: "Filtruje podle publishera"
                                    },
                                    {
                                        name: "themes[]",
                                        in: "query",
                                        required: false,
                                        schema: {
                                            type: "string"
                                        },
                                        description: "Filtruje podle t√©matu datov√© sady (nap≈ô. finance, doprava, kultura)"
                                    },
                                    {
                                        name: "limit",
                                        in: "query",
                                        required: false,
                                        schema: {
                                            type: "integer"
                                        },
                                        description: "Maxim√°ln√≠ poƒçet v√Ωsledk≈Ø"
                                    },
                                    {
                                        name: "offset",
                                        in: "query",
                                        required: false,
                                        schema: {
                                            type: "integer"
                                        },
                                        description: "Offset pro str√°nkov√°n√≠"
                                    }
                                ],
                                responses: {
                                    "200": {
                                        description: "Seznam datov√Ωch sad (ƒçist√Ω JSON)",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    type: "array",
                                                    items: {
                                                        type: "object",
                                                        properties: {
                                                            iri: {
                                                                type: "string"
                                                            },
                                                            title: {
                                                                type: "string"
                                                            },
                                                            description: {
                                                                type: "string"
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "/organizations": {
                            get: {
                                operationId: "getOrganizationListLKOD",
                                summary: "Z√≠skat seznam organizac√≠",
                                parameters: [
                                    {
                                        name: "format",
                                        in: "query",
                                        required: true,
                                        schema: {
                                            type: "string",
                                            enum: [format],
                                            default: format
                                        },
                                        description: "Form√°t odpovƒõdi (v≈ædy json)"
                                    },
                                    {
                                        name: "limit",
                                        in: "query",
                                        required: false,
                                        schema: {
                                            type: "integer"
                                        },
                                        description: "Maxim√°ln√≠ poƒçet v√Ωsledk≈Ø"
                                    },
                                    {
                                        name: "offset",
                                        in: "query",
                                        required: false,
                                        schema: {
                                            type: "integer"
                                        },
                                        description: "Offset pro str√°nkov√°n√≠"
                                    }
                                ],
                                responses: {
                                    "200": {
                                        description: "Seznam organizac√≠ poskytuj√≠c√≠ch data",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    type: "array",
                                                    items: {
                                                        type: "object",
                                                        properties: {
                                                            iri: {
                                                                type: "string"
                                                            },
                                                            title: {
                                                                type: "string"
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "/distributions": {
                            get: {
                                operationId: "getDistributionListLKOD",
                                summary: "Z√≠skat seznam distribuc√≠ datov√Ωch sad",
                                parameters: [
                                    {
                                        name: "format",
                                        in: "query",
                                        required: true,
                                        schema: {
                                            type: "string",
                                            enum: [format],
                                            default: format
                                        },
                                        description: "Form√°t odpovƒõdi (v≈ædy json)"
                                    },
                                    {
                                        name: "limit",
                                        in: "query",
                                        required: false,
                                        schema: {
                                            type: "integer"
                                        },
                                        description: "Maxim√°ln√≠ poƒçet v√Ωsledk≈Ø"
                                    },
                                    {
                                        name: "offset",
                                        in: "query",
                                        required: false,
                                        schema: {
                                            type: "integer"
                                        },
                                        description: "Offset pro str√°nkov√°n√≠"
                                    }
                                ],
                                responses: {
                                    "200": {
                                        description: "Seznam distribuc√≠",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    type: "array",
                                                    items: {
                                                        type: "object",
                                                        properties: {
                                                            iri: {
                                                                type: "string"
                                                            },
                                                            accessURL: {
                                                                type: "string"
                                                            },
                                                            mediaType: {
                                                                type: "string"
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                };

                return spec;
            };

            const handleGenerate = async () => {
                setLoading(true);
                setInfoMessages([]);

                // Simulate brief processing time
                await new Promise(resolve => setTimeout(resolve, 500));

                try {
                    const cleanUrl = url.replace(/\/$/, '');
                    
                    const messages = [
                        `üîç Analyzuji LKOD API: ${cleanUrl}`,
                        `üìã Generuji endpointy podle DCAT-AP-CZ standardu`,
                        `‚úÖ /catalog - katalog otev≈ôen√Ωch dat`,
                        `‚úÖ /datasets - seznam datov√Ωch sad`,
                        `‚úÖ /organizations - seznam organizac√≠`,
                        `‚úÖ /distributions - distribuce dat`,
                        `‚öôÔ∏è P≈ôid√°ny parametry: format=${defaultFormat}, publisher, themes[], limit, offset`,
                        `üéØ OpenAPI 3.1 specifikace vygenerov√°na √∫spƒõ≈°nƒõ!`
                    ];
                    
                    setInfoMessages(messages);
                    const spec = generateOpenAPISpec(cleanUrl, name, description, defaultFormat);
                    setResult(spec);
                } catch (err) {
                    alert('Chyba p≈ôi generov√°n√≠: ' + err.message);
                } finally {
                    setLoading(false);
                }
            };

            const copyToClipboard = () => {
                navigator.clipboard.writeText(JSON.stringify(result, null, 2));
                alert('‚úÖ OpenAPI specifikace zkop√≠rov√°na do schr√°nky!');
            };

            const downloadJSON = () => {
                const blob = new Blob([JSON.stringify(result, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'mcp-server-spec.json';
                a.click();
                URL.revokeObjectURL(url);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 py-8 px-4">
                    <div className="max-w-6xl mx-auto">
                        {/* Header */}
                        <div className="gradient-bg text-white rounded-2xl shadow-2xl p-8 mb-8">
                            <h1 className="text-4xl font-bold mb-3">üß© MCP Builder</h1>
                            <p className="text-lg opacity-90">Auto-Generator ChatGPT Actions z ve≈ôejn√Ωch API</p>
                            <p className="text-sm opacity-75 mt-2">Automaticky vytvo≈ô√≠ OpenAPI 3.1 specifikaci podle DCAT-AP-CZ standardu</p>
                        </div>

                        {/* Input Form */}
                        <div className="bg-white rounded-2xl shadow-xl p-8 mb-8">
                            <h2 className="text-2xl font-bold text-gray-800 mb-6">‚öôÔ∏è Konfigurace</h2>
                            
                            <div className="space-y-5">
                                {/* URL Input */}
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        URL ve≈ôejn√©ho LKOD API *
                                    </label>
                                    <input
                                        type="text"
                                        value={url}
                                        onChange={(e) => setUrl(e.target.value)}
                                        placeholder="https://api.opendata.praha.eu/lod"
                                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none transition"
                                    />
                                </div>

                                {/* Name */}
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        N√°zev MCP serveru (voliteln√©)
                                    </label>
                                    <input
                                        type="text"
                                        value={name}
                                        onChange={(e) => setName(e.target.value)}
                                        placeholder="LKOD MCP Server"
                                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none transition"
                                    />
                                </div>

                                {/* Description */}
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        Popis (voliteln√©)
                                    </label>
                                    <textarea
                                        value={description}
                                        onChange={(e) => setDescription(e.target.value)}
                                        placeholder="MCP server pro p≈ô√≠stup k otev≈ôen√Ωm dat≈Øm..."
                                        rows="3"
                                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none transition"
                                    />
                                </div>

                                {/* Format */}
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        V√Ωchoz√≠ form√°t
                                    </label>
                                    <select
                                        value={defaultFormat}
                                        onChange={(e) => setDefaultFormat(e.target.value)}
                                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none transition"
                                    >
                                        <option value="json">JSON</option>
                                        <option value="jsonld">JSON-LD</option>
                                    </select>
                                </div>
                            </div>

                            {/* Generate Button */}
                            <button
                                onClick={handleGenerate}
                                disabled={loading || !url}
                                className="w-full mt-8 bg-gradient-to-r from-purple-600 to-blue-600 text-white font-bold py-4 px-6 rounded-lg hover:from-purple-700 hover:to-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed shadow-lg"
                            >
                                {loading ? 'üîÑ Generuji...' : 'üöÄ Generovat MCP specifikaci'}
                            </button>
                        </div>

                        {/* Loading */}
                        {loading && (
                            <div className="bg-white rounded-2xl shadow-xl p-8 mb-8 text-center">
                                <div className="loader mx-auto mb-4"></div>
                                <p className="text-gray-600">Generuji OpenAPI 3.1 specifikaci...</p>
                            </div>
                        )}

                        {/* Info Messages */}
                        {infoMessages.length > 0 && (
                            <div className="bg-white rounded-2xl shadow-xl p-8 mb-8">
                                <h3 className="text-xl font-bold text-gray-800 mb-4">üìã Proces generov√°n√≠</h3>
                                <div className="space-y-2 font-mono text-sm">
                                    {infoMessages.map((msg, idx) => (
                                        <div key={idx} className="text-gray-700">{msg}</div>
                                    ))}
                                </div>
                                <div className="mt-4 p-4 bg-blue-50 rounded-lg border border-blue-200">
                                    <p className="text-sm text-blue-800">
                                        üí° <strong>Pozn√°mka:</strong> Specifikace je generov√°na podle DCAT-AP-CZ standardu 
                                        bez live testov√°n√≠ API (kv≈Øli CORS omezen√≠m v prohl√≠≈æeƒçi).
                                    </p>
                                </div>
                            </div>
                        )}

                        {/* Result */}
                        {result && (
                            <div className="bg-white rounded-2xl shadow-xl p-8">
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="text-2xl font-bold text-gray-800">‚úÖ OpenAPI 3.1 Specifikace</h3>
                                    <div className="flex gap-3">
                                        <button
                                            onClick={copyToClipboard}
                                            className="bg-blue-600 text-white px-5 py-2 rounded-lg hover:bg-blue-700 transition font-semibold shadow"
                                        >
                                            üìã Kop√≠rovat
                                        </button>
                                        <button
                                            onClick={downloadJSON}
                                            className="bg-green-600 text-white px-5 py-2 rounded-lg hover:bg-green-700 transition font-semibold shadow"
                                        >
                                            üíæ St√°hnout JSON
                                        </button>
                                    </div>
                                </div>

                                <div className="code-block p-6">
                                    <pre className="text-green-400 text-sm overflow-x-auto">
                                        {JSON.stringify(result, null, 2)}
                                    </pre>
                                </div>

                                <div className="mt-6 p-6 bg-blue-50 rounded-lg border-2 border-blue-200">
                                    <h4 className="font-bold text-blue-900 mb-3">üí° Jak pou≈æ√≠t v ChatGPT:</h4>
                                    <ol className="list-decimal list-inside space-y-2 text-blue-800">
                                        <li>Zkop√≠rujte nebo st√°hnƒõte JSON specifikaci v√Ω≈°e</li>
                                        <li>V ChatGPT otev≈ôete "GPTs" ‚Üí "Create a GPT"</li>
                                        <li>Kliknƒõte na "Configure" ‚Üí "Actions" ‚Üí "Create new action"</li>
                                        <li>Vlo≈æte JSON do pole "Schema"</li>
                                        <li>Nastavte "Authentication" na "None"</li>
                                        <li>Kliknƒõte "Save" a otestujte akci</li>
                                    </ol>
                                </div>
                            </div>
                        )}

                        {/* Info Box */}
                        <div className="mt-8 bg-gradient-to-r from-purple-100 to-blue-100 rounded-2xl p-8 border-2 border-purple-200">
                            <h3 className="text-xl font-bold text-purple-900 mb-4">üß† Co aplikace dƒõl√°?</h3>
                            <div className="grid md:grid-cols-2 gap-4 text-purple-900">
                                <div>
                                    <div className="font-semibold mb-2">üîç Standardn√≠ LKOD endpointy</div>
                                    <p className="text-sm">/catalog, /datasets, /organizations, /distributions</p>
                                </div>
                                <div>
                                    <div className="font-semibold mb-2">üß© OpenAPI 3.1 + x-mcp</div>
                                    <p className="text-sm">Validn√≠ specifikace s MCP metadaty</p>
                                </div>
                                <div>
                                    <div className="font-semibold mb-2">üí¨ P≈ôipraveno pro ChatGPT</div>
                                    <p className="text-sm">Okam≈æitƒõ pou≈æiteln√© jako Custom Action</p>
                                </div>
                                <div>
                                    <div className="font-semibold mb-2">‚öôÔ∏è DCAT-AP-CZ standard</div>
                                    <p className="text-sm">Parametry podle ƒçesk√© specifikace</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<MCPBuilder />, document.getElementById('root'));
    </script>
</body>
</html>
