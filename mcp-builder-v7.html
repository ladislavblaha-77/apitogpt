<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß© MCP Builder - LKOD Metadata API</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .code-block {
            background: #1e1e1e;
            border-radius: 8px;
            overflow: auto;
            max-height: 500px;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        function MCPBuilder() {
            const [url, setUrl] = useState('https://api.opendata.praha.eu/lod');
            const [name, setName] = useState('');
            const [description, setDescription] = useState('');
            const [result, setResult] = useState(null);

            const generateLKODSpec = (baseUrl, customName, customDescription, publisherFilter) => {
                // Build catalog parameters
                const catalogParams = [
                    {
                        name: "format",
                        in: "query",
                        required: true,
                        schema: {
                            type: "string",
                            enum: ["json"],
                            default: "json"
                        },
                        description: "Form√°t odpovƒõdi - pouze JSON je podporov√°n pro ChatGPT"
                    }
                ];

                // Add publisher filter if provided
                if (publisherFilter) {
                    catalogParams.push({
                        name: "publishers[]",
                        in: "query",
                        required: true,
                        schema: {
                            type: "string",
                            enum: [publisherFilter],
                            default: publisherFilter
                        },
                        description: `Filtr podle poskytovatele (${publisherFilter})`
                    });
                }

                const spec = {
                    openapi: "3.1.0",
                    info: {
                        title: customName || `LKOD Metadata API - ${publisherFilter ? publisherFilter.toUpperCase() : 'Praha'}`,
                        description: customDescription || `API pro ƒçten√≠ metadat z Lok√°ln√≠ho katalogu otev≈ôen√Ωch dat${publisherFilter ? ' poskytovatele ' + publisherFilter.toUpperCase() : ' Prahy'} (DCAT-AP kompatibiln√≠)`,
                        version: "1.0.0"
                    },
                    "x-mcp": {
                        name: (customName || `lkod_${publisherFilter || 'metadata'}`).toLowerCase().replace(/\s+/g, '_'),
                        description: customDescription || `LKOD - metadata o kataloz√≠ch a datov√Ωch sad√°ch${publisherFilter ? ' (' + publisherFilter.toUpperCase() + ')' : ''}`
                    },
                    servers: [
                        {
                            url: baseUrl,
                            description: "LKOD API endpoint pro metadata"
                        }
                    ],
                    paths: {
                        "/catalog": {
                            get: {
                                operationId: "getCatalog",
                                summary: "Z√≠skat metadata katalogu",
                                description: `Vrac√≠ informace o katalogu otev≈ôen√Ωch dat${publisherFilter ? ' pro poskytovatele ' + publisherFilter.toUpperCase() : ''} vƒçetnƒõ seznamu IRI datov√Ωch sad`,
                                parameters: catalogParams,
                                responses: {
                                    "200": {
                                        description: "Metadata katalogu v JSON form√°tu",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    type: "object",
                                                    properties: {
                                                        "@context": { type: "string" },
                                                        "@type": { type: "string" },
                                                        iri: { type: "string", description: "IRI katalogu" },
                                                        title: { 
                                                            type: "object",
                                                            description: "N√°zev katalogu v r≈Øzn√Ωch jazyc√≠ch"
                                                        },
                                                        description: { 
                                                            type: "object",
                                                            description: "Popis katalogu"
                                                        },
                                                        homepage: { type: "string", description: "Domovsk√° str√°nka katalogu" },
                                                        publisher: { 
                                                            type: "object",
                                                            description: "Poskytovatel katalogu"
                                                        },
                                                        datasets: {
                                                            type: "array",
                                                            description: "Seznam IRI v≈°ech datov√Ωch sad v katalogu",
                                                            items: { type: "string" }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "/datasets": {
                            get: {
                                operationId: "getDatasets",
                                summary: "Z√≠skat seznam datov√Ωch sad s metadaty",
                                description: `Vrac√≠ seznam v≈°ech datov√Ωch sad${publisherFilter ? ' poskytovatele ' + publisherFilter.toUpperCase() : ''} s jejich kompletn√≠mi metadaty. Pozn√°mka: Tento endpoint vrac√≠ velk√© mno≈æstv√≠ dat, pou≈æijte s rozvahou.`,
                                parameters: catalogParams,
                                responses: {
                                    "200": {
                                        description: "Seznam datov√Ωch sad",
                                        content: {
                                            "application/json": {
                                                schema: {
                                                    type: "array",
                                                    items: {
                                                        type: "object",
                                                        properties: {
                                                            "@type": { type: "string" },
                                                            iri: { type: "string" },
                                                            title: { 
                                                                type: "object",
                                                                description: "N√°zev datov√© sady"
                                                            },
                                                            description: { 
                                                                type: "object",
                                                                description: "Popis datov√© sady"
                                                            },
                                                            keyword: { 
                                                                type: "array",
                                                                description: "Kl√≠ƒçov√° slova"
                                                            },
                                                            theme: { 
                                                                type: "array",
                                                                description: "T√©mata (nap≈ô. doprava, finance)"
                                                            },
                                                            accrualPeriodicity: { 
                                                                type: "string",
                                                                description: "Frekvence aktualizace"
                                                            },
                                                            spatial: { 
                                                                type: "object",
                                                                description: "Geografick√© pokryt√≠"
                                                            },
                                                            publisher: {
                                                                type: "object",
                                                                description: "Poskytovatel dat"
                                                            },
                                                            distribution: {
                                                                type: "array",
                                                                description: "Distribuce (soubory ke sta≈æen√≠)",
                                                                items: {
                                                                    type: "object",
                                                                    properties: {
                                                                        accessURL: { type: "string" },
                                                                        downloadURL: { type: "string" },
                                                                        format: { type: "string" },
                                                                        mediaType: { type: "string" }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                };

                return spec;
            };

            const handleGenerate = () => {
                let cleanUrl = url.trim();
                let publisherParam = null;
                
                // Extract publisher parameter if present
                if (cleanUrl.includes('?publishers')) {
                    const urlParts = cleanUrl.split('?');
                    cleanUrl = urlParts[0];
                    
                    // Parse publisher parameter
                    const params = new URLSearchParams(urlParts[1]);
                    const publishers = params.get('publishers[]');
                    if (publishers) {
                        publisherParam = publishers;
                    }
                }
                
                // Remove trailing slash
                cleanUrl = cleanUrl.replace(/\/$/, '');
                
                // Remove /catalog endpoint if present (but keep the base)
                if (cleanUrl.endsWith('/catalog')) {
                    cleanUrl = cleanUrl.slice(0, -'/catalog'.length);
                }
                
                const spec = generateLKODSpec(cleanUrl, name, description, publisherParam);
                setResult(spec);
            };

            const copyToClipboard = () => {
                navigator.clipboard.writeText(JSON.stringify(result, null, 2));
                alert('‚úÖ OpenAPI specifikace zkop√≠rov√°na do schr√°nky!');
            };

            const downloadJSON = () => {
                const blob = new Blob([JSON.stringify(result, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'lkod-metadata-spec.json';
                a.click();
                URL.revokeObjectURL(url);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 py-8 px-4">
                    <div className="max-w-6xl mx-auto">
                        <div className="gradient-bg text-white rounded-2xl shadow-2xl p-8 mb-8">
                            <h1 className="text-4xl font-bold mb-3">üß© MCP Builder</h1>
                            <p className="text-lg opacity-90">Generator pro LKOD Metadata API</p>
                            <p className="text-sm opacity-75 mt-2">Vytvo≈ô√≠ OpenAPI specifikaci pro ƒçten√≠ metadat z Lok√°ln√≠ho katalogu otev≈ôen√Ωch dat</p>
                        </div>

                        <div className="bg-blue-50 border-2 border-blue-300 rounded-2xl p-6 mb-8">
                            <h3 className="font-bold text-blue-900 mb-3">‚ÑπÔ∏è Co tato specifikace umo≈æ≈àuje:</h3>
                            <ul className="space-y-2 text-blue-800">
                                <li>‚úÖ ƒå√≠st metadata o kataloz√≠ch otev≈ôen√Ωch dat</li>
                                <li>‚úÖ Z√≠skat seznam v≈°ech datov√Ωch sad</li>
                                <li>‚úÖ Zobrazit n√°zvy, popisy, t√©mata dataset≈Ø</li>
                                <li>‚úÖ Zjistit form√°ty a download URL soubor≈Ø</li>
                                <li>‚ùå Neposkytuje vyhled√°v√°n√≠ nebo filtrov√°n√≠ (LKOD je statick√Ω)</li>
                                <li>üí° Pro real-time data a vyhled√°v√°n√≠ pou≈æijte Golemio API</li>
                            </ul>
                        </div>

                        <div className="bg-white rounded-2xl shadow-xl p-8 mb-8">
                            <h2 className="text-2xl font-bold text-gray-800 mb-6">‚öôÔ∏è Konfigurace</h2>
                            
                            <div className="space-y-5">
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        URL LKOD API *
                                    </label>
                                    <input
                                        type="text"
                                        value={url}
                                        onChange={(e) => setUrl(e.target.value)}
                                        placeholder="https://api.opendata.praha.eu/lod"
                                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none transition"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        N√°zev (voliteln√©)
                                    </label>
                                    <input
                                        type="text"
                                        value={name}
                                        onChange={(e) => setName(e.target.value)}
                                        placeholder="LKOD Metadata API - Praha"
                                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none transition"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">
                                        Popis (voliteln√©)
                                    </label>
                                    <textarea
                                        value={description}
                                        onChange={(e) => setDescription(e.target.value)}
                                        placeholder="API pro ƒçten√≠ metadat z katalogu..."
                                        rows="3"
                                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-purple-500 focus:outline-none transition"
                                    />
                                </div>
                            </div>

                            <button
                                onClick={handleGenerate}
                                disabled={!url}
                                className="w-full mt-8 bg-gradient-to-r from-purple-600 to-blue-600 text-white font-bold py-4 px-6 rounded-lg hover:from-purple-700 hover:to-blue-700 transition disabled:opacity-50 disabled:cursor-not-allowed shadow-lg"
                            >
                                üöÄ Generovat specifikaci
                            </button>
                        </div>

                        {result && (
                            <div className="bg-white rounded-2xl shadow-xl p-8">
                                <div className="mb-6 p-4 bg-green-50 border-2 border-green-300 rounded-lg">
                                    <p className="text-sm text-green-800 mb-2">
                                        ‚úÖ <strong>Base URL:</strong> <code className="bg-white px-2 py-1 rounded text-sm">{result.servers[0].url}</code>
                                    </p>
                                    {result.paths["/catalog"].get.parameters.find(p => p.name === "publishers[]") && (
                                        <p className="text-sm text-green-800">
                                            üè¢ <strong>Filtr poskytovatele:</strong> <code className="bg-white px-2 py-1 rounded text-sm">
                                                {result.paths["/catalog"].get.parameters.find(p => p.name === "publishers[]").schema.default}
                                            </code>
                                        </p>
                                    )}
                                </div>
                                
                                <div className="flex justify-between items-center mb-6">
                                    <h3 className="text-2xl font-bold text-gray-800">‚úÖ OpenAPI 3.1 Specifikace</h3>
                                    <div className="flex gap-3">
                                        <button
                                            onClick={copyToClipboard}
                                            className="bg-blue-600 text-white px-5 py-2 rounded-lg hover:bg-blue-700 transition font-semibold shadow"
                                        >
                                            üìã Kop√≠rovat
                                        </button>
                                        <button
                                            onClick={downloadJSON}
                                            className="bg-green-600 text-white px-5 py-2 rounded-lg hover:bg-green-700 transition font-semibold shadow"
                                        >
                                            üíæ St√°hnout
                                        </button>
                                    </div>
                                </div>

                                <div className="code-block p-6">
                                    <pre className="text-green-400 text-sm overflow-x-auto">
                                        {JSON.stringify(result, null, 2)}
                                    </pre>
                                </div>

                                <div className="mt-6 p-6 bg-blue-50 rounded-lg border-2 border-blue-200">
                                    <h4 className="font-bold text-blue-900 mb-3">üí° Jak pou≈æ√≠t v ChatGPT:</h4>
                                    <ol className="list-decimal list-inside space-y-2 text-blue-800">
                                        <li>Zkop√≠rujte JSON specifikaci v√Ω≈°e</li>
                                        <li>V ChatGPT: GPTs ‚Üí Create a GPT ‚Üí Configure ‚Üí Actions</li>
                                        <li>Vlo≈æte JSON do pole "Schema"</li>
                                        <li>Authentication: <strong>None</strong> (LKOD nevy≈æaduje API kl√≠ƒç)</li>
                                        <li>Save a testujte: "Zobraz mi katalog otev≈ôen√Ωch dat Prahy"</li>
                                    </ol>
                                </div>

                                <div className="mt-4 p-6 bg-yellow-50 rounded-lg border-2 border-yellow-200">
                                    <h4 className="font-bold text-yellow-900 mb-3">‚ö†Ô∏è Omezen√≠:</h4>
                                    <ul className="list-disc list-inside space-y-1 text-yellow-800">
                                        <li>LKOD vrac√≠ pouze metadata, ne skuteƒçn√° data</li>
                                        <li>Nepodporuje vyhled√°v√°n√≠ podle kl√≠ƒçov√Ωch slov</li>
                                        <li>Nepodporuje filtrov√°n√≠ podle t√©matu nebo poskytovatele</li>
                                        <li>Endpoint /datasets vrac√≠ velk√© mno≈æstv√≠ dat najednou</li>
                                        <li>Pro real-time data pou≈æijte Golemio API m√≠sto LKOD</li>
                                    </ul>
                                </div>
                            </div>
                        )}

                        <div className="mt-8 bg-gradient-to-r from-purple-100 to-blue-100 rounded-2xl p-8 border-2 border-purple-200">
                            <h3 className="text-xl font-bold text-purple-900 mb-4">üìö Co je LKOD?</h3>
                            <p className="text-purple-800 mb-4">
                                Lok√°ln√≠ katalog otev≈ôen√Ωch dat (LKOD) je syst√©m pro spr√°vu metadat o otev≈ôen√Ωch datech. 
                                Poskytuje <strong>statick√© JSON-LD soubory</strong> s informacemi o datov√Ωch sad√°ch, jejich poskytovatel√≠ch, 
                                form√°tech a download URL.
                            </p>
                            <div className="grid md:grid-cols-2 gap-4 text-purple-900">
                                <div>
                                    <div className="font-semibold mb-2">‚úÖ LKOD je vhodn√Ω pro:</div>
                                    <ul className="text-sm space-y-1">
                                        <li>‚Ä¢ Prohl√≠≈æen√≠ katalogu dataset≈Ø</li>
                                        <li>‚Ä¢ Z√≠sk√°n√≠ metadat o datech</li>
                                        <li>‚Ä¢ Zji≈°tƒõn√≠ download URL</li>
                                    </ul>
                                </div>
                                <div>
                                    <div className="font-semibold mb-2">‚ùå LKOD NEN√ç vhodn√Ω pro:</div>
                                    <ul className="text-sm space-y-1">
                                        <li>‚Ä¢ Vyhled√°v√°n√≠ a filtrov√°n√≠</li>
                                        <li>‚Ä¢ Real-time data</li>
                                        <li>‚Ä¢ Interaktivn√≠ dotazy</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<MCPBuilder />, document.getElementById('root'));
    </script>
</body>
</html>